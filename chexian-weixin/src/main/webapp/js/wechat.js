$(document)		.ready(				function() {					// var link_test=					// "http://xiguamei.com:8083/wechat/share.html?invite=";					// var link_test=					// "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxbcbd557ee763bf7c&redirect_uri=http%3A%2F%2Fwechat.xiguamei.com%2Fwechat%2Fshare.html&response_type=code&scope=snsapi_userinfo&state=#wechat_redirect";					var redirect_uri = 'http://wechat.xiguamei.com/wechat/share.html?invite=INVITE';					var link = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxbcbd557ee763bf7c&redirect_uri=URI&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect';					var title = "西瓜妹小游戏 - 开心游戏,轻松赚钱!";					var imgUrl = 'http://wechat.xiguamei.com/wechat/images/logo.jpg';					var desc = "天天做任务,天天有钱花,邀请好友可以得到20%额外奖励,轻轻松松月入上千!";					var url = window.location.href;					var begin = url.indexOf('code', 0) + 5;					var end = url.indexOf('&state', begin);					end = (-1 == end) ? url.length : end;					// var code = /code=(\d+)/.exec(window.location.search);					var invite = null;					var invites = /invite=(\d+)/.exec(window.location.search);					if (invites) {						invite = invites[1];						$('#invite').html(invite);						redirect_uri = redirect_uri.replace('INVITE', invite);					}					var code = url.substring(begin, end);					var timestamp = new Date().getTime().toString().substring(							0, 10);//					alert("invite: " + invite);					//访问分享页面					if (invites) {						$.post('record', {							invite : invite,							code : code						}, function(data) {						}, 'json');					}					else{						$.post('invite', {							code : code						}, function(data) {							inviteCode = data.invite;							$('#invite').html(inviteCode);							redirect_uri = redirect_uri.replace('INVITE', inviteCode);							redirect_uri = encodeURIComponent(redirect_uri);							link = link.replace('URI', redirect_uri).replace(									'STATE', inviteCode);							redirect_uri = redirect_uri.replace('INVITE', invite);						}, 'json');					}					$.post('signature', {						url : url,						timestamp : timestamp					}, function(data) {						wx.config({							debug : false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。							appId : 'wxbcbd557ee763bf7c', // 必填，公众号的唯一标识							timestamp : timestamp, // 必填，生成签名的时间戳							nonceStr : 'xiguamei', // 必填，生成签名的随机串							signature : data.signature,// 必填，签名，见API文档附录1							jsApiList : [ 'onMenuShareTimeline',									'onMenuShareAppMessage', 'showMenuItems',									'hideMenuItems' ]						// 必填，需要使用的JS接口列表，所有JS接口列表见API文档附录2						});					}, 'json');										/*					$.post('share', {						invite : invite,						code : code,						url : url,						timestamp : timestamp					}, function(data) {						var signature = data.signature;						var inviteCode = data.inviteCode;						if ('######' === $('#invite').html()								&& "" != inviteCode) {							// 修改页面的邀请码显示							$('#invite').html(inviteCode);						}						redirect_uri = redirect_uri.replace('INVITE', inviteCode);						redirect_uri = encodeURIComponent(redirect_uri);						link = link.replace('URI', redirect_uri).replace(								'STATE', inviteCode);						wx.config({							debug : false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。							appId : 'wxbcbd557ee763bf7c', // 必填，公众号的唯一标识							timestamp : timestamp, // 必填，生成签名的时间戳							nonceStr : 'xiguamei', // 必填，生成签名的随机串							signature : signature,// 必填，签名，见API文档附录1							jsApiList : [ 'onMenuShareTimeline',									'onMenuShareAppMessage', 'showMenuItems',									'hideMenuItems' ]						// 必填，需要使用的JS接口列表，所有JS接口列表见API文档附录2						});					}, 'json');					*/					// config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。					wx.ready(function() {						wx.showMenuItems({							menuList : [ 'menuItem:profile' ]						// 要显示的菜单项，所有menu项见API文档附录3						});						wx.hideMenuItems({							menuList : [ 'menuItem:readMode',									'menuItem:favorite', 'menuItem:copyUrl',									'menuItem:openWithQQBrowser',									'menuItem:openWithSafari' ]						// 要隐藏的菜单项，只能隐藏“传播类”和“保护类”按钮，所有menu项见API文档附录3						});						wx.onMenuShareTimeline({							title : title, // 分享标题							link : link, // 分享链接							imgUrl : imgUrl, // 分享图标							success : function() {								// 用户确认分享后执行的回调函数							},							cancel : function() {								// 用户取消分享后执行的回调函数							}						});						wx.onMenuShareAppMessage({							title : title, // 分享标题							desc : desc, // 分享描述							link : link, // 分享链接							imgUrl : imgUrl, // 分享图标							type : 'link', // 分享类型,music、video或link，不填默认为link							dataUrl : '', // 如果type是music或video，则要提供数据链接，默认为空							success : function() {								// 用户确认分享后执行的回调函数							},							cancel : function() {								// 用户取消分享后执行的回调函数							}						});					});					// config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。					wx.error(function(res) {						// alert(res);					});				});